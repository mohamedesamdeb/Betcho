<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>بن بيتشو — متجر البن</title>
  <meta name="description" content="تطبيق موبايل لشراء بن من مصنع بن بيتشو — قوائم منتجات، عربة تسوق، حساب المجموع، حذف وتعديل الكميات." />
  <style>
    :root{
      --bg:#f6f5f3;
      --card:#ffffff;
      --accent:#6b3f1a;
      --accent-2:#a36b3d;
      --muted:#7a7a7a;
      --glass: rgba(255,255,255,0.6);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg),#efece8);color:#222}

    .app{max-width:420px;margin:12px auto;background:transparent;padding:12px;}
    header{display:flex;align-items:center;gap:12px;justify-content:space-between;background:linear-gradient(90deg,var(--card),#fff);border-radius:14px;padding:10px 12px;box-shadow:0 6px 20px rgba(107,63,26,0.08);position:sticky;top:12px;z-index:4}
    .brand{display:flex;align-items:center;gap:10px}
.logo {
  width: 48px;
  height: 48px;
  border-radius: 10px;
  background: url('logo.png') center/contain no-repeat;
}
    .brand h1{margin:0;font-size:16px}
    .brand p{margin:0;font-size:11px;color:var(--muted)}

    .products{margin-top:14px;display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .product{background:var(--card);border-radius:12px;padding:10px;display:flex;flex-direction:column;gap:8px;align-items:stretch;box-shadow:0 6px 18px rgba(27,27,27,0.04);}
    .imgwrap{width:100%;aspect-ratio:1.2/1;border-radius:8px;overflow:hidden;display:grid;place-items:center;background:linear-gradient(180deg, #fbf8f5, #fff)}
    .imgwrap img{width:100%;height:100%;object-fit:cover}
    .pname{font-weight:600;font-size:14px;margin:0}
    .pmeta{display:flex;justify-content:space-between;align-items:center;gap:8px}
    .price{font-size:14px;font-weight:700;color:var(--accent)}
    .muted{font-size:12px;color:var(--muted)}
    .actions{display:flex;gap:8px;align-items:center}
    .btn{border:0;padding:8px 10px;border-radius:10px;background:var(--accent);color:#fff;font-weight:600;cursor:pointer}
    .btn.ghost{background:transparent;color:var(--accent);border:1px solid rgba(107,63,26,0.12)}

    /* drawer من الشمال */
    .drawer {
      position: fixed;
      top: 0;
      left: 0;
      width: 300px;
      height: 100%;
      background: linear-gradient(180deg, rgba(255,255,255,0.98), #fff);
      border-radius: 0 18px 18px 0;
      padding: 12px;
      box-shadow: 4px 0 30px rgba(0,0,0,0.08);
      overflow-y: auto;
      z-index: 40;
      transform: translateX(-100%);
      transition: transform 0.3s ease;
    }
    .drawer.open {
      transform: translateX(0);
    }
    .drawer .handle{width:42px;height:6px;background:#e9e3df;border-radius:999px;margin:6px auto}
    .cartitems{display:flex;flex-direction:column;gap:10px;margin-top:6px}
    .cartitem{display:flex;gap:10px;align-items:center}
    .cartitem .thumb{width:64px;height:64px;border-radius:10px;overflow:hidden;background:#fff;display:grid;place-items:center}
    .cartitem .meta{flex:1}
    .qtyctrl{display:flex;align-items:center;gap:6px}
    .qtyctrl button{border:0;background:#f1f1f1;padding:6px 8px;border-radius:8px;cursor:pointer}

    .summary{display:flex;justify-content:space-between;align-items:center;padding:10px 6px;border-radius:10px;background:linear-gradient(180deg,#fff,#faf8f6);box-shadow:inset 0 1px 0 rgba(255,255,255,0.6)}
    footer.info{margin-top:80px;text-align:center;color:var(--muted);font-size:12px;padding-bottom:90px}

    @media(min-width:480px){.products{grid-template-columns:1fr 1fr}}
    .hide{display:none}
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="brand">
      <div class="logo">
  <img src="./betcho.jpg" alt="بن بيتشو" style="width:100%; height:100%; object-fit:contain; border-radius:10px;">
</div>

        <div>
          <h1>بن بيتشو</h1>
          <p>قهوة مصنع — طلب سريع للعميل</p>
        </div>
      </div>
      <button id="cart-toggle" style="background:transparent;border:0;cursor:pointer;padding:4px;position:relative">
  <svg width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="9" cy="21" r="1"></circle>
    <circle cx="20" cy="21" r="1"></circle>
    <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
  </svg>
  <span id="cart-count" style="position:absolute;top:-6px;right:-6px;background:var(--accent);color:#fff;border-radius:50%;padding:0 6px;font-size:11px">0</span>
</button>

    </header>

    <main>
      <section style="margin-top:12px">
        <div style="display:flex;gap:8px;align-items:center;justify-content:space-between">
          <h2 style="margin:0;font-size:16px">منتجاتنا</h2>
          <small class="muted">اختر الوزن واضف إلى العربة</small>
        </div>
        <div class="products" id="products"></div>
      </section>
      <div class="info"> 
        <p class="muted" style="text-align:center;margin-top:12px">مناسب للعرض على الموبايل — يمكنك تخصيص الاصناف، الاسعار، ورفع صور حقيقية.</p>
      </div>
    </main>

    <div id="drawer" class="drawer" aria-hidden="true">
      <div class="handle"></div>
      <div style="display:flex;justify-content:space-between;align-items:center">
        <h3 style="margin:6px 0">عربة التسوق</h3>
        <div style="display:flex;gap:8px;align-items:center">
          <button id="clear-cart" class="btn ghost">تفريغ</button>
          <button id="close-drawer" class="btn">اغلاق</button>
        </div>
      </div>
      <div class="cartitems" id="cart-items-list"></div>
      <div style="margin-top:10px;display:flex;flex-direction:column;gap:8px">
        <div class="summary">
          <div>
            <div style="font-size:13px;color:var(--muted)">المجموع</div>
            <div style="font-weight:800;font-size:19px;color:var(--accent)" id="total">0 ج.م</div>
          </div>
          <div>
            <button id="checkout" class="btn">المتابعة للدفع</button>
          </div>
        </div>
        <small style="text-align:center;color:var(--muted)">- الدفع غير متاح في النسخة التجريبية — هذه واجهة أمامية فقط -</small>
      </div>
    </div>

    <footer class="info"></footer>
  </div>

  <script>
    const PRODUCTS = [
      { id: 'b1', name: 'بن بيتشو - كيس 1 كيلو', weight: '1 كجم', price: 450, img: '1.jpg' },
      { id: 'b2', name: 'بن بيتشو - نصف كيلو', weight: '0.5 كجم', price: 240, img: '2.jpg' },
      { id: 'b3', name: 'بن بيتشو - ربع كيلو', weight: '0.25 كجم', price: 130, img: '3.jpg' },
      { id: 'b4', name: 'بن بيتشو - 125 جرام', weight: '0.125 كجم', price: 75, img: '4.jpg' }
    ];

    function placeholderSVG(text){
      const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='600' height='400'><rect width='100%' height='100%' fill='%23f5efe9'/><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' font-size='28' fill='%236b3f1a' font-family='Segoe UI'>${text}</text></svg>`;
      return 'data:image/svg+xml;utf8,' + encodeURIComponent(svg);
    }
    //PRODUCTS.forEach(p => p.img = placeholderSVG(p.name));

    const productsEl = document.getElementById('products');
    const cartCountEl = document.getElementById('cart-count');
    const cartItemsLabel = document.createElement('small');
    cartItemsLabel.id = "cart-items";
    cartItemsLabel.style.display = "none"; 
    document.body.appendChild(cartItemsLabel);

    const drawer = document.getElementById('drawer');
    const openCartBtn = document.getElementById('cart-toggle');
    const closeDrawerBtn = document.getElementById('close-drawer');
    const cartItemsList = document.getElementById('cart-items-list');
    const totalEl = document.getElementById('total');
    const clearCartBtn = document.getElementById('clear-cart');
    const checkoutBtn = document.getElementById('checkout');

    let CART = {};

    function saveCart(){ localStorage.setItem('betcho_cart', JSON.stringify(CART)); }
    function loadCart(){ try{ CART = JSON.parse(localStorage.getItem('betcho_cart')) || {}; }catch(e){ CART = {}; } }

    function renderProducts(){
      productsEl.innerHTML='';
      PRODUCTS.forEach(p=>{
        const card = document.createElement('div'); card.className='product';
        card.innerHTML = `
          <div class="imgwrap"><img src="${p.img}" alt="${p.name}"></div>
          <div style="display:flex;flex-direction:column;gap:6px">
            <p class="pname">${p.name}</p>
            <div class="pmeta">
              <span class="muted">${p.weight}</span>
              <span class="price">${p.price} ج.م</span>
            </div>
            <div class="actions">
              <button class="btn" data-id="${p.id}">اضف إلى العربة</button>
              <button class="btn ghost" onclick="alert('معلومات المنتج: ${p.name} — السعر: ${p.price} ج.م')">تفاصيل</button>
            </div>
          </div>
        `;
        productsEl.appendChild(card);
      });
      document.querySelectorAll('.product .btn').forEach(b=>{
        const id = b.dataset.id; if(!id) return;
        b.addEventListener('click', ()=>addToCart(id));
      });
    }

    function addToCart(id){
      const p = PRODUCTS.find(x=>x.id===id); if(!p) return;
      if(CART[id]) CART[id].qty += 1; else CART[id] = {...p, qty:1};
      saveCart(); renderCartSummary(); bleep();
    }

    function bleep(){
      openCartBtn.animate([{transform:'translateY(0)'},{transform:'translateY(-6px)'},{transform:'translateY(0)'}],{duration:300});
    }

    function removeFromCart(id){ delete CART[id]; saveCart(); renderCartSummary(); }
    function changeQty(id, qty){ if(!CART[id]) return; CART[id].qty = qty; if(CART[id].qty<=0) delete CART[id]; saveCart(); renderCartSummary(); }
    function clearCart(){ CART = {}; saveCart(); renderCartSummary(); }

    function renderCartSummary(){
      const items = Object.values(CART);
      const totalQty = items.reduce((s,i)=>s+i.qty,0);
      const totalAmount = items.reduce((s,i)=>s + i.qty * i.price,0);
      cartCountEl.textContent = totalQty;
      cartItemsLabel.textContent = `${totalQty} منتجات`;

      cartItemsList.innerHTML = '';
      if(items.length===0){ cartItemsList.innerHTML = '<p class="muted" style="text-align:center">العربة فارغة — اضف منتجات من القائمة</p>'; }
     items.forEach((it, index) => {
  const el = document.createElement('div');
  el.className = 'cartitem';
  el.innerHTML = `
    <div class="thumb">
      <img src="${it.img}" alt="${it.name}" style="width:100%;height:100%;object-fit:cover">
    </div>
    <div class="meta">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <div style="font-weight:700">${it.name}</div>
          <div class="muted" style="font-size:12px">${it.weight} • ${it.price} ج.م لكل وحدة</div>
        </div>
        <div style="text-align:right">
          <div style="font-weight:800">${formatCurrency(it.qty * it.price)}</div>
          <div class="muted" style="font-size:11px">${it.qty} × ${it.price} ج.م</div>
        </div>
      </div>
      <div style="margin-top:8px;display:flex;justify-content:space-between;align-items:center">
        <div class="qtyctrl">
          <button onclick="changeQty('${it.id}', ${it.qty - 1})">-</button>
          <div style="min-width:28px;text-align:center">${it.qty}</div>
          <button onclick="changeQty('${it.id}', ${it.qty + 1})">+</button>
        </div>
        <div>
          <button class="btn ghost" onclick="removeFromCart('${it.id}')">حذف</button>
        </div>
      </div>
    </div>
  `;
  cartItemsList.appendChild(el);

  // إضافة فاصل بعد كل عنصر إلا آخر عنصر
  if (index < items.length - 1) {
    const hr = document.createElement('hr');
    hr.style.border = '0';
    hr.style.height = '1px';
    hr.style.background = '#eee';
    hr.style.margin = '8px 0';
    cartItemsList.appendChild(hr);
  }
});

      totalEl.textContent = formatCurrency(totalAmount);
    }

    function formatCurrency(n){ return new Intl.NumberFormat('ar-EG').format(n) + ' ج.م'; }

    function openDrawer(){ drawer.classList.add('open'); drawer.setAttribute('aria-hidden','false'); }
    function closeDrawer(){ drawer.classList.remove('open'); drawer.setAttribute('aria-hidden','true'); }

    loadCart(); renderProducts(); renderCartSummary();

    openCartBtn.addEventListener('click', ()=>{ openDrawer(); });
    closeDrawerBtn.addEventListener('click', ()=>{ closeDrawer(); });
    clearCartBtn.addEventListener('click', ()=>{ if(confirm('هل تريد تفريغ العربة؟')) clearCart(); });
    checkoutBtn.addEventListener('click', ()=>{
      const items = Object.values(CART);
      if(items.length===0){ alert('العربة فارغة. الرجاء إضافة منتجات أولاً.'); return; }
      alert('تم إنشاء الطلب تجريبيًا. إجمالي الطلب: ' + totalEl.textContent + '\n(هذه واجهة أمامية — ربط الدفع والـ backend مطلوب)');
    });

    window.addToCart = addToCart; 
    window.changeQty = changeQty; 
    window.removeFromCart = removeFromCart; 
    window.clearCart = clearCart;

    document.querySelector('footer.info').textContent = `مصنع بن بيتشو — © ${new Date().getFullYear()}`;
  </script>
</body>
</html>
